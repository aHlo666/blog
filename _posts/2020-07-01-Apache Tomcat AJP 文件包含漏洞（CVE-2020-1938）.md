---
layout: post
title: Tomcat AJP 文件包含漏洞
tags: Tomcat
categories: CVE-2020-1938
---

# Apache Tomcat AJP 文件包含漏洞（CVE-2020-1938）

## 漏洞描述

该漏洞是由于Tomcat AJP协议设计上存在缺陷，攻击者通过Tomcat AJP Connector可以读取或包含Tomcat上所有webapp目录下的任意文件，例如可以读取webapp配置文件或源代码。此外在目标应用有文件上传功能的情况下，配合文件包含的利用还可以达到远程代码执行的危害。

## 漏洞复现

首先部署是使用的GitHub中的[vulhub](!https://github.com/vulhub/vulhub.git)项目docker一键部署的。环境启动后，访问`http://your-ip:8080`即可查看tomcat默认页面，此时通过AJP协议的8009端口亦可访问Tomcat。

使用[python脚本](!https://www.exploit-db.com/exploits/48143)读取webapp目录下的任意文件

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Tomcat/CVE-2020-1938/15927498349927.jpg)

脚本可以用-p指定端口（默认8009），-f指定路径（默认WEB-INF/web.xml）

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Tomcat/CVE-2020-1938/15928116056992.jpg)

## 受影响的版本

Apache Tomcat 6
Apache Tomcat 7x <7.0.100
Apache Tomcat 8x <8.5.51
Apache Tomcat 9x <9.0.31