---
layout: post
title: Django < 2.0.8 任意URL跳转漏洞
tags: Django
categories: CVE-2018-14574
---

# Django < 2.0.8 任意URL跳转漏洞（CVE-2018-14574）

## 漏洞描述

Django默认配置下，如果匹配上的URL路由中最后一位是/，而用户访问的时候没加/，Django默认会跳转到带/的请求中。（由配置项中的django.middleware.common.CommonMiddleware、APPEND_SLASH来决定）。

在path开头为//example.com的情况下，Django没做处理，导致浏览器认为目的地址是绝对路径，最终造成任意URL跳转漏洞。

该漏洞利用条件是目标URLCONF中存在能匹配上//example.com的规则。

## 漏洞复现

首先部署是使用的GitHub中的[vulhub](!https://github.com/vulhub/vulhub.git)项目docker一键部署的。

环境启动后，访问`http://your-ip:8000`，即可查看网站首页

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Django/CVE-2018-14574/15946982668349.jpg)

然后访问`http://your-ip:8000//www.baidu.com`可以看到返回301

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Django/CVE-2018-14574/15946982486679.jpg)

跳转到百度

![](https://github.com/aHlo666/blog-image/raw/master/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Django/CVE-2018-14574/15946984210296.jpg)

## 受影响版本

Django 1.11.x < 1.11.15
Django 2.0.x < 2.0.8